SELECT mmt.organization_id,
       msi.segment1,
       mmt.primary_quantity qty,
       inv_project.get_locator(mmt.locator_id, mmt.organization_id) LOCATOR,--
       mmt.costed_flag,
       mmt.pm_cost_collected,
       mmt.source_code,
       mmt.project_id,
       mmt.task_id,
       mmt.*
  FROM mtl_material_transactions mmt,
       mtl_system_items_b        msi
 WHERE 1 = 1
   AND mmt.inventory_item_id = msi.inventory_item_id
   AND mmt.organization_id = msi.organization_id
      --AND mmt.transaction_id = 54868663--60911685--8915869
   AND mmt.last_update_date > trunc(SYSDATE) - 4 --SYSDATE - 2
   AND mmt.created_by = 4270
      --AND mmt.organization_id = 83
      --AND msi.segment1 = '1000EX-EN'
   --AND rownum = 1
   ORDER BY mmt.transaction_id
   ;

SELECT decode(mmt.organization_id, 86, 'FAC', 85, 'HO', mmt.organization_id) org,
       (SELECT msi.segment1
          FROM mtl_system_items_b msi
         WHERE 1 = 1
           AND msi.inventory_item_id = mmt.inventory_item_id
           AND msi.organization_id = mmt.organization_id) item,
       mmt.primary_quantity qty,
       --mmt.transaction_type_id,
       (SELECT mtt.transaction_type_name
          FROM mtl_transaction_types mtt
         WHERE 1 = 1
           AND mtt.transaction_type_id = mmt.transaction_type_id) trx_type,
       mmt.source_code,
       mmt.locator_id,
       mmt.project_id,
       (SELECT ppa.segment1 prj_num
          FROM pa_projects_all ppa
         WHERE 1 = 1
           AND ppa.project_id = mmt.project_id) prj_num,
       mmt.task_id,
       (SELECT pt.task_number
          FROM pa_tasks pt
         WHERE 1 = 1
           AND pt.task_id = mmt.task_id) task,
       mmt.costed_flag,
       mmt.pm_cost_collected,
       mmt.*
  FROM mtl_material_transactions mmt
 WHERE 1 = 1
   AND mmt.last_update_date > trunc(SYSDATE) - 3
   AND mmt.created_by = 4270
;

--1.transaction_type_id refer to mtl_transaction_types
SELECT *
  FROM mtl_transaction_types mtt
 WHERE 1 = 1
--AND mtt.transaction_type_id
 ORDER BY mtt.creation_date --mtt.transaction_type_id
;

--2.transaction_action_id refer to lookup 'MTL_TRANSACTION_ACTION'
SELECT *
  FROM mfg_lookups v
 WHERE v.lookup_type = 'MTL_TRANSACTION_ACTION'
 ORDER BY v.lookup_code;

--3.transaction_source_id refer to 
SELECT *
  FROM wip_discrete_jobs wdj;

--4.transaction_source_type_id refer to mtl_txn_source_types
SELECT mts.transaction_source_type_id   trx_src_id,
       mts.transaction_source_type_name trx_src,
       --mts.transaction_source_category trx_cate,
       mts.description des,
       mts.*
  FROM mtl_txn_source_types mts;

--xla
SELECT xte.source_id_int_1,
       xte.*
  FROM xla.xla_transaction_entities xte
 WHERE 1 = 1
      --AND xte.source_id_int_1 = 43901381
   AND xte.application_id = 707
   AND xte.security_id_int_1 = 83
   AND xte.creation_date > SYSDATE - 2;

SELECT xte.source_id_int_1,
       xte.*
  FROM xla.xla_transaction_entities xte,
       xla_ae_headers               xah,
       xla_ae_lines                 xal
 WHERE 1 = 1
   AND xte.entity_id(+) = xah.entity_id
   AND xte.application_id(+) = xah.application_id
   AND xah.ae_header_id = xal.ae_header_id
   AND xte.source_id_int_1 = 43901381
   AND xte.application_id = 707
   AND xte.security_id_int_1 = 83
   AND xte.creation_date > SYSDATE - 2;
   
INV_PROJECT.GET_LOCATOR(MMT.LOCATOR_ID, MMT.ORGANIZATION_ID) LOCATOR

--org_id      Resp_id     Resp_app_id        Organization_id
--HBS 101     51249       660                HB1  121
--HEA 82      50676       660                SG1  83
--HET 141     51272       20005              HE1  161
--SHE 84      50778       20005              TH1  85  TH2 86
/*
BEGIN
  fnd_global.apps_initialize(user_id      => 4270,
                             resp_id      => 50676,
                             resp_appl_id => 660);
  mo_global.init('M');
  FND_PROFILE.PUT('MFG_ORGANIZATION_ID', 86);
  
END;
*/
